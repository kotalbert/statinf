--
title: "Statistical Inference Course Project"
author: "Pawel Daniluk"
date: "2016-11-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999)
```

## Summary

This report is a final assignment of Statistical Inference Course Project. The report was written using **knitr** package.The demonstrated plots were drawn using **base** plotting system. 

The report is divided into two parts. First part covers the demonstration of simulation of exponentially distributed random variable, and then applying [Central Limit Theorem](https://en.wikipedia.org/wiki/Central_limit_theorem) to investigate the distribution of sample mean of the exponential distribution.

Second part of the report is dedicated t inferential analysis of `ToothGrowth` data set. 

`TODO: finish summary for part 2`

## Part 1: Exponential Distribution Simulation

First part of the project focuses on the simulation of large set of random data. After random data is generated, the theoretical and empirical distribution are compared. Finally, the random data is grouped into series of random samples. The distribution of random sample mean is them examined if it adheres to Central Limit Theorem assumptions.

### Generating random data

The Exponential distribution is described with a parameter $\lambda$. 
In the course project, $\lambda$ parameter is set to be 0.2.
The theoretical mean and standard deviation are equal and given as follows:

$\mu=1/\lambda=1/0.2=5$

$\sigma=1/\lambda=1/0.2=5$

First exponential random variable simulation is to generate large volume of random data. 
First, the random seed will be set, to ensure reproducible results. The random data is grouped in samples, 40 observation per sample.
The Exponential distribution is probability distribution that describes the time between events in a Poisson process, as described in [Wikipedia](https://en.wikipedia.org/wiki/Exponential_distribution).

```{r sim}
# set random seed
set.seed(123456)

# total number of random samples
nsim <- 10000

# number of random observation per sample
obs <- 40

# lambda parameter for distribution
lbd = 0.2

# simulate random numbers
x <- matrix(rexp(nsim*obs, lbd), ncol=obs)
```

The random values were saved in matrix. 
For the purpose of the exercise, `r nsim` random samples were generated, each containing `r obs` observations. 
Total number of generated random numbers is `r nsim * obs`. The generated random numbers were saved as matrix, in order to facilitate calculation of sample means. 

The following histogram displays the empirical distribution of randomly generated exponentials. The break widths are set to be equal to 1. The red vertival line indicates the distribution mean. It can be noted, that the exponential distribution is not symetrical, therefore, values are not obviously centered around mean value.

```{r emp_hist}
hist(x, col="lightblue", freq=F, main="Histogram of Exponential Random Distribution", breaks=60)
abline(v=5, lw=2, col="red")
```

Furthenr investigation of empirical statistics indicates, that both empirical mean(m) and standard deviation(s) are close to theoretical values of $\mu$ and $\sigma$ of the Exponential Distribution.
The sample statistics are calculated as follows:

m=`r mean(x)`

s=`r sd(x)`

Finally, 

### Sample mean distribution 

In order to investigate the distribution of sample mean distribution, each for each random sample, empirical mean was calculated. The resulting data was a vector of `r nsim` elements.

Using `apply` function allows to calculate required statistics over matrix dimensions. In this case, the **mean** function is calculated over matrix **x** rows, i.e. mean is calculated for each of random samples.

The following histogram illustrates the distribution of random sample means. 

```{r means}
# Calculate the samples means
sm <- apply(x, 1, mean)
hist(sm, col="lightblue", freq=F, main="Histogram of Sample Means", breaks=9)
abline(v=5, lw=2, col="red")
```

According to Central Limit Theorem, the distribution of mean of random samples, follow Normal distribution with mean $\mu_s=\mu$ and standard deviation $\sigma_s = \sigma/\sqrt(n)$.

Since `r obs` random variables were generated in each sample.Let $_s$ denote sample mean parameters. Ujjjr this assumptions we expect the sample mean and standard deviation to be as follows:


$\mu_s = 1/\lambda=5$

$\sigma_s = \frac{1}{\lambda * \sqrt(n)} = \frac{1}{0.2 * \sqrt(40)} = 0.7906$

Indeed, the calculated results are confirming the expectations. Empirical mean and standard deviation are as follows:

$m=`r mean(sm)`$

$s = `r sd(sm)`$

The theoretical and empirical results are closely matched. Finally, Normal distribution density plot is  overlayer over histogram of sample means. As expected, histogram and density plot are matching are close to each other. This confirms out expectations under CLT.

```{r ovrl}
# Draw histogram
hist(sm, col="lightblue", freq=F, main="Histogram of Sample Means", breaks=9)

# Overlay normal density plot N(m,s)
xfit <- seq(min(sm), max(sm), length=100)
yfit <- dnorm(xfit, mean=mean(sm), sd=sd(sm))
lines(xfit, yfit, col="red", lwd=2)
```

## Part 2: Inferential Data Analysis

The second part of the report covers inferential analysis of `ToothGrowth` dataset. First, basic exploratory data analysis will be performed. Then, tooth growth will be compared by **supp** and **dose** attributes, using t-test techniques.  

### Date description

The `ToothGrowthi` dataset describes the Effect of Vitamin C on Tooth Growth in Guinea Pigs. The [detailed description](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/ToothGrowth.html) can be found in the `R` documentation.

There are 60 observations and three variables:

    1. **len**  Tooth length 
    2. **supp** Supplement type (Ascorbic Acid or Orange Juice)
    3. **dose** Dose in mg/day 

### Exploratory analysis


### Statistical inference


